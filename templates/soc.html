{% load static %}
<html>
<header>
<script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
<title>CSIRT</title>
<link rel="stylesheet" href="{% static 'css/main_css.css' %}">
</header>

<body>
<div class="Top_Nav">
    <div class="dropdown">
        <button class="Top_Nav_Button" onclick="location.href='{% url 'index' %}'">CVE</button>
       
    </div>
    <div class="dropdown">
        <button class="Top_Nav_Button" onclick="location.href='{% url 'shodan' %}'">Attack surface</button>
        <div class="dropdown-content">
          <a onclick="location.href='{% url 'shodan' %}'">Shodan</a>
        </div>
    </div>
    <button class="Top_Nav_Button" onclick="location.href='{% url 'qualys' %}'">Qualys</button>

</div>
<div class="CVE_table">
<h2>SOC Tools</h2>
<p>This section contains tools that can be used by a SOC operative to research an incident.<br>
The user can input an IP, Hash, domain and get results from various sources.</p>

<p>Insert url</p>
<form action="soc_scan_url" method="post">
{% csrf_token %}
<label>Enter domain: <input class="scan_url_label" type="text" name="scan_url_entry" size=30></label>
<button class="scan_url_button" type="submit">eNDER</button>
</form>

{% if URLScan %}
<h2>Scan results</h2>
    <table class="sortable">
    <thead>
        <th>Domain</th>
        <th>URL</th>
        <th>IP</th>
        <th>Time</th>
        <th>Title</th>
        <th>Country</th>
        <th>Server</th>
        <th>ASN Name</th>
        <th>Full results.json</th>
        <th>Screenshot</th>
    </thead>
    {% for Entry in URLScan %}
    <tr>
        <td><a href="http://{{Entry.task.domain}}">{{Entry.task.domain}}</a></td>
        <td><a href="http://{{Entry.task.url}}">{{Entry.task.url}}</a></td>
        <td>{{Entry.page.ip}}</td>
        <td>{{Entry.task.time}}</td>
        <td>{{Entry.page.title}}</td>
        <td>{{Entry.page.country}}</td>
        <td>{{Entry.page.server}}</td>
        <td>{{Entry.page.asnname}}</td>
        
        <td><a href="{{Entry.result}}" target="_blank">Full resultset</td>
        <td><a href="{{Entry.screenshot}}"><img src="{{Entry.screenshot}}" width="300px" height="200px"></a></td>
    </tr>
    {% endfor %}
</table>
{% endif %}

</div>
</html>
