{% extends "base.html" %}

{% block title %}Attack surface{% endblock %}

{% block content %}
{% load custom_tags %}

<div class="CVE_Table_Header">
    <h1>Eksponerte porter</h1>
    <p>Her ligger oversikten over alle eksponerte porter og tjenestene som kjører på dem.</p>
</div>
<hr class="CVE_Table_HR">

<div class="TableFilters">
  
</div>


{% if user|has_group:'CSIRT' %}

{% if PortData %}
<div class="CVE_table">
    <div class="table-responsive">
        <table class="table table-striped sortable">
            <thead>
              <tr>
                <th>Domain</th>
                <th>Port</th>
                <th>Protocol</th>
                <th>Service</th>
              </tr>
            </thead>
            <tbody>
              {% for domain, ports in PortData.items %}
                {% for port in ports %}
                  <tr>
                    <td><a href="{% url 'attack_surface_search_by_domain' domain %}" class="toggle-click">
                        {{ domain }}
                    </a></td>
                    <td>{{ port.port }}</td>
                    <td>{{ port.protocol }}</td>
                    <td>{{ port.service }}</td>
                  </tr>
                {% endfor %}
              {% endfor %}
            </tbody>
  </table>
</div>
</div>
{% else %}
  <p>No port data available.</p>
{% endif %}
   

{% endif %}
{% endblock %}