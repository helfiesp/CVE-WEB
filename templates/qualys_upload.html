{% extends 'base.html' %}
{% load custom_tags %}

<title>Last opp sårbarheter</title>
<p>Bruk denne siden for å laste opp .xlsx ark med sårbarheter.<br>
   Siden støtter i dag kun Qualys data.<br>
   Ved opplasting av korrekt fil vil det også gjøres et direktesøk i Shodan og sjekkes opp mot kartoteket.<br>

   <b>OBS:</b><br> Siden kan stå å kjøre i opp til 10 minutter etter fil er lastet opp.<br>
   Når opplasting er ferdig vil det vises nederst på siden.<br>
    Ikke lukk fanen før opplasting er ferdig.</p>

{% block content %}
<div class="CVE_table">
  {% if message %}
    <p>{{ message }}</p>
  {% endif %}

  <h2>Last opp sårbarhetsfil</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <label for="vulnerability_type">Velg type sårbarhetsfil:</label>
    <p>Godtatte filtyper: .xlsx</p>
    <select name="vulnerability_type" id="vulnerability_type">
      <option value="Qualys">Qualys</option>
      <option value="Defender">Defender</option>
    </select>
    <br><br>
    <label for="file">Velg fil:</label>
    <input type="file" name="file" id="file">
    <br><br>
    <button type="submit">Upload</button>
  </form>

  {% if output %}
    <h2>Opplasting ferdig:</h2>
    <p>Nedenfor ligger informasjon fra serveren og eventuelle error.</p>
    <pre>{{ output }}</pre>
  {% endif %}
</div>
{% endblock %}