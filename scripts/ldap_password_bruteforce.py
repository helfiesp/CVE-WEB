import os, ldap, time
from misc_scripts import secrets

ldap_server  = 'ldaps://ldaps.oslofelles.oslo.kommune.no:636'
username  = os.environ["CSIRT_LDAPUSER"]
password  = os.environ["CSIRT_LDAPPASSWORD"]
base_dn =  "DC=oslofelles,DC=oslo,DC=kommune,DC=no"

ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)
ldap.set_option(ldap.OPT_PROTOCOL_VERSION, 3)
ldap_conn = ldap.initialize(ldap_server)
ldap_conn.set_option(ldap.OPT_REFERRALS, 0)

usernames = ["User1", "User2", "User3", "User4", "User5"]
passwords = ["Hello123", "Password", "Winter", "Summer", "Easter", "Dinner", "Football", "Basketball"]

pass_length = len(passwords)
pass_start = 0
pass_end = 3
incrementvalue = 3


while pass_length >= pass_end:
    for user in usernames:
        print("Checking user: {}, pass range {}: {}".format(user, pass_start, pass_end))
        for pwd in passwords[pass_start:pass_end]:
            print("{}: {}".format(user, pwd))
    pass_start += incrementvalue
    pass_end += incrementvalue
    print(pass_start, pass_end)


