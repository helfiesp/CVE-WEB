import sqlite3
import json

# Connect to the SQLite database
db_path = "/var/csirt/source/CVE-WEB/db.sqlite3"
conn = sqlite3.connect(db_path)
cursor = conn.cursor()

# Select the latest data from the alerts_nessusdata table
select_query = "SELECT data FROM alerts_nessusdata ORDER BY date DESC LIMIT 1"
cursor.execute(select_query)
latest_data_json = cursor.fetchone()

if latest_data_json is not None:
    latest_data = json.loads(latest_data_json[0])
    dataset = latest_data.get("data")
    if dataset:
        print(dataset[:100])
    else:
        print("No data found in the database.")
else:
    print("No data found in the database.")

# Close the connection
conn.close()