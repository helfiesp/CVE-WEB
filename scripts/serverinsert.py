import sqlite3
import sqliteconnect as SQLC
from misc_scripts import secrets
import os
import subprocess
import json
import requests
import time


def InsertServerData(ip, comment):
	sql = "UPDATE alerts_shodanresults SET entry_comments=? WHERE entry_ip=?"
	values = (comment, ip)
	conn = SQLC.SQLiteConnect()
	cur = conn.cursor()
	cur.execute(sql,values)
	conn.commit()
	conn.close()

def GetData(serverfile):
	with open(serverfile) as file:
		server_entries = [line.rstrip() for line in file]
	for entry in server_entries:
		entry = entry.split("|")
		ip = entry[0]
		comment = entry[1]
		InsertServerData(ip, comment)

GetData("/var/csirt/source/CVE-WEB/scripts/scriptfiles/servers.txt")